<!DOCTYPE html>

<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gangetabel Træning</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/lucide@latest/dist/lucide.css">
    <style>
        /* Custom styles for icons */
        .lucide {
            width: 1.5rem;
            height: 1.5rem;
            display: inline-block;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div id="root"></div>

```
<script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Lucide React icons as components
    const Icon = ({ name, className = "" }) => {
        const icons = {
            Trophy: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 9a6 6 0 1 0 12 0H6Z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v6"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.5 21h5"/></svg>`,
            Star: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon stroke-linecap="round" stroke-linejoin="round" stroke-width="2" points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`,
            Target: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="10" stroke-width="2"/><circle cx="12" cy="12" r="6" stroke-width="2"/><circle cx="12" cy="12" r="2" stroke-width="2"/></svg>`,
            Clock: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="10" stroke-width="2"/><polyline points="12 6 12 12 16 14" stroke-width="2"/></svg>`,
            CheckCircle: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01" stroke-width="2"/></svg>`,
            XCircle: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="10" stroke-width="2"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 9-6 6"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 9 6 6"/></svg>`,
            BarChart3: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3v18h18"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 17V9"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17V5"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 17v-3"/></svg>`,
            Zap: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" stroke-width="2"/></svg>`,
            Play: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon points="5 3 19 12 5 21 5 3" stroke-width="2"/></svg>`,
            Book: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>`,
            Settings: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="3" stroke-width="2"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 1v6m0 6v6m4.22-15.22l-4.24 4.24m-1.98 1.98l-4.24 4.24m20.24-6.46h-6m-6 0h-6m15.22 4.22l-4.24-4.24m-1.98-1.98l-4.24-4.24"/></svg>`,
            ArrowLeft: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19-7-7 7-7"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 12H5"/></svg>`,
            Volume2: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" stroke-width="2"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>`,
            VolumeX: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" stroke-width="2"/><line x1="23" y1="9" x2="17" y2="15" stroke-width="2"/><line x1="17" y1="9" x2="23" y2="15" stroke-width="2"/></svg>`,
            Lightbulb: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 22h4"/></svg>`
        };
        
        return (
            <span 
                className={`lucide ${className}`} 
                dangerouslySetInnerHTML={{ __html: icons[name] || '' }}
            />
        );
    };

    const GangetabelApp = () => {
      // State management
      const [currentMode, setCurrentMode] = useState('menu');
      const [selectedTables, setSelectedTables] = useState([2, 3, 4, 5]);
      const [practiceType, setPracticeType] = useState('multiple');
      const [practiceLength, setPracticeLength] = useState(10);
      const [currentQuestion, setCurrentQuestion] = useState(null);
      const [userAnswer, setUserAnswer] = useState('');
      const [feedback, setFeedback] = useState(null);
      const [sessionStats, setSessionStats] = useState({ correct: 0, total: 0 });
      const [streak, setStreak] = useState(0);
      const [showNextButton, setShowNextButton] = useState(false);
      const [isSessionActive, setIsSessionActive] = useState(false);
      const [soundEnabled, setSoundEnabled] = useState(true);
      const [showHint, setShowHint] = useState(false);
      const [hintUsed, setHintUsed] = useState(false);
      
      // Audio refs
      const correctSoundRef = useRef(null);
      const incorrectSoundRef = useRef(null);
      const clickSoundRef = useRef(null);
      
      // Progress tracking
      const [progress, setProgress] = useState(() => {
        const saved = localStorage.getItem('gangetabelProgress');
        return saved ? JSON.parse(saved) : {
          facts: {},
          totalPoints: 0,
          level: 1,
          dailyStreak: 0,
          lastPractice: null
        };
      });

      // Save progress
      useEffect(() => {
        localStorage.setItem('gangetabelProgress', JSON.stringify(progress));
      }, [progress]);

      // Initialize audio on component mount
      useEffect(() => {
        // Create audio elements with simple sine wave sounds
        correctSoundRef.current = new Audio('data:audio/wav;base64,UklGRiQFAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAFAACAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIA=');
        incorrectSoundRef.current = new Audio('data:audio/wav;base64,UklGRmAFAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YTwFAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIA=');
        clickSoundRef.current = new Audio('data:audio/wav;base64,UklGRjABAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQwBAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACA');
        
        if (correctSoundRef.current) correctSoundRef.current.volume = 0.3;
        if (incorrectSoundRef.current) incorrectSoundRef.current.volume = 0.3;
        if (clickSoundRef.current) clickSoundRef.current.volume = 0.2;
      }, []);

      // Play sound helper
      const playSound = (type) => {
        if (!soundEnabled) return;
        
        try {
          if (type === 'correct' && correctSoundRef.current) {
            correctSoundRef.current.currentTime = 0;
            correctSoundRef.current.play();
          } else if (type === 'incorrect' && incorrectSoundRef.current) {
            incorrectSoundRef.current.currentTime = 0;
            incorrectSoundRef.current.play();
          } else if (type === 'click' && clickSoundRef.current) {
            clickSoundRef.current.currentTime = 0;
            clickSoundRef.current.play();
          }
        } catch (error) {
          console.log('Audio play failed:', error);
        }
      };

      // Vibrate helper
      const vibrate = (pattern) => {
        if (!soundEnabled) return;
        if ('vibrate' in navigator) {
          navigator.vibrate(pattern);
        }
      };

      // Generate hint for multiplication
      const generateHint = (a, b) => {
        const hints = [];
        
        if (a > 5 && a !== 10) {
          hints.push(`Prøv at dele op: ${a}×${b} = (5×${b}) + (${a-5}×${b}) = ${5*b} + ${(a-5)*b}`);
        }
        
        if (a === 4 || a === 8) {
          if (a === 4) {
            hints.push(`${a}×${b} er det dobbelte af 2×${b} = ${2*b}, så svaret er ${2*b}×2`);
          } else {
            hints.push(`${a}×${b} er det dobbelte af 4×${b} = ${4*b}, så svaret er ${4*b}×2`);
          }
        }
        
        if (a === 9) {
          hints.push(`${a}×${b} = (10×${b}) - ${b} = ${10*b} - ${b}`);
        }
        
        if (b > a) {
          hints.push(`Husk: ${a}×${b} er det samme som ${b}×${a}`);
        }
        
        if (a === 5) {
          hints.push(`5-tabellen har et mønster: Slutter altid på 0 eller 5`);
        }
        
        if (a === b) {
          hints.push(`${a}×${b} er et kvadrattal (${a} i anden)`);
        }
        
        if (hints.length === 0) {
          hints.push(`Tænk på ${a} grupper med ${b} i hver gruppe`);
        }
        
        return hints[Math.floor(Math.random() * hints.length)];
      };

      // Generate question
      const generateQuestion = () => {
        const now = Date.now();
        let candidates = [];
        
        selectedTables.forEach(table => {
          for (let i = 1; i <= 10; i++) {
            const key = `${table}x${i}`;
            const fact = progress.facts[key];
            
            if (!fact || !fact.nextReview || fact.nextReview <= now) {
              candidates.push({ a: table, b: i, priority: fact ? 1 : 2 });
            }
          }
        });
        
        if (candidates.length < 5) {
          selectedTables.forEach(table => {
            for (let i = 1; i <= 10; i++) {
              if (Math.random() < 0.3) {
                candidates.push({ a: table, b: i, priority: 0 });
              }
            }
          });
        }
        
        if (candidates.length === 0) {
          selectedTables.forEach(table => {
            for (let i = 1; i <= 10; i++) {
              candidates.push({ a: table, b: i, priority: 0 });
            }
          });
        }
        
        candidates.sort((a, b) => b.priority - a.priority);
        const question = candidates[Math.floor(Math.random() * Math.min(4, candidates.length))];
        
        if (question) {
          const correctAnswer = question.a * question.b;
          let options = [correctAnswer];
          
          while (options.length < 4) {
            const wrongAnswer = correctAnswer + (Math.random() < 0.5 ? -1 : 1) * 
                               Math.floor(Math.random() * 10 + 1);
            if (wrongAnswer > 0 && !options.includes(wrongAnswer)) {
              options.push(wrongAnswer);
            }
          }
          
          options.sort(() => Math.random() - 0.5);
          
          setCurrentQuestion({
            ...question,
            answer: correctAnswer,
            options: options
          });
        }
      };

      // Handle answer submission
      const handleAnswer = (answer) => {
        playSound('click');
        const isCorrect = answer === currentQuestion.answer;
        const key = `${currentQuestion.a}x${currentQuestion.b}`;
        
        if (isCorrect) {
          playSound('correct');
          vibrate([50, 100, 50]);
        } else {
          playSound('incorrect');
          vibrate([200]);
        }
        
        setProgress(prev => {
          const newFacts = { ...prev.facts };
          const fact = newFacts[key] || { correct: 0, attempts: 0 };
          
          fact.attempts++;
          if (isCorrect) {
            fact.correct++;
            fact.lastSeen = Date.now();
            
            const accuracy = fact.correct / fact.attempts;
            let interval;
            if (accuracy >= 0.9) {
              interval = 7 * 24 * 60 * 60 * 1000;
            } else if (accuracy >= 0.7) {
              interval = 3 * 24 * 60 * 60 * 1000;
            } else if (accuracy >= 0.5) {
              interval = 24 * 60 * 60 * 1000;
            } else {
              interval = 60 * 60 * 1000;
            }
            fact.nextReview = Date.now() + interval;
          }
          
          newFacts[key] = fact;
          
          return {
            ...prev,
            facts: newFacts,
            totalPoints: prev.totalPoints + (isCorrect ? 10 : 0),
            level: Math.floor((prev.totalPoints + (isCorrect ? 10 : 0)) / 100) + 1,
            lastPractice: Date.now()
          };
        });
        
        setSessionStats(prev => ({
          correct: prev.correct + (isCorrect ? 1 : 0),
          total: prev.total + 1
        }));
        
        setStreak(isCorrect ? streak + 1 : 0);
        setFeedback({ isCorrect, correctAnswer: currentQuestion.answer });
        setShowNextButton(true);
        
        if (isCorrect && hintUsed) {
          setHintUsed(false);
        }
      };

      // Handle next question
      const handleNextQuestion = () => {
        setShowNextButton(false);
        setFeedback(null);
        setUserAnswer('');
        setShowHint(false);
        setHintUsed(false);
        generateQuestion();
      };

      // Settings component
      const SettingsPage = () => {
        return (
          <div className="p-4 max-w-md mx-auto">
            <div className="flex items-center gap-4 mb-6">
              <button
                onClick={() => setCurrentMode('menu')}
                className="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors"
              >
                <Icon name="ArrowLeft" className="w-5 h-5" />
                <span>Tilbage</span>
              </button>
              <h2 className="text-2xl font-bold">Indstillinger</h2>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
              <h3 className="font-bold text-lg mb-4">Vælg tabeller til øvelser</h3>
              <div className="grid grid-cols-5 gap-2 mb-6">
                {[1,2,3,4,5,6,7,8,9,10].map(n => (
                  <button
                    key={n}
                    onClick={() => {
                      setSelectedTables(prev => 
                        prev.includes(n) 
                          ? prev.filter(t => t !== n)
                          : [...prev, n]
                      );
                    }}
                    className={`p-3 rounded-lg font-medium transition-all ${
                      selectedTables.includes(n)
                        ? 'bg-blue-500 text-white'
                        : 'bg-gray-100 hover:bg-gray-200'
                    }`}
                  >
                    {n}
                  </button>
                ))}
              </div>
              <p className="text-sm text-gray-600">
                Valgte tabeller: {selectedTables.sort((a,b) => a-b).join(', ')}
              </p>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
              <h3 className="font-bold text-lg mb-4">Øvelsestype</h3>
              <div className="space-y-3">
                <label className="flex items-center p-3 rounded-lg cursor-pointer hover:bg-gray-50">
                  <input
                    type="radio"
                    checked={practiceType === 'multiple'}
                    onChange={() => setPracticeType('multiple')}
                    className="mr-3"
                  />
                  <div>
                    <p className="font-medium">Valgmuligheder</p>
                    <p className="text-sm text-gray-600">Vælg mellem 4 mulige svar</p>
                  </div>
                </label>
                <label className="flex items-center p-3 rounded-lg cursor-pointer hover:bg-gray-50">
                  <input
                    type="radio"
                    checked={practiceType === 'input'}
                    onChange={() => setPracticeType('input')}
                    className="mr-3"
                  />
                  <div>
                    <p className="font-medium">Indtast svar</p>
                    <p className="text-sm text-gray-600">Skriv svaret selv</p>
                  </div>
                </label>
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
              <h3 className="font-bold text-lg mb-4">Antal opgaver per øvelse</h3>
              <div className="space-y-3">
                {[5, 10, 15, 20].map(num => (
                  <label key={num} className="flex items-center p-3 rounded-lg cursor-pointer hover:bg-gray-50">
                    <input
                      type="radio"
                      checked={practiceLength === num}
                      onChange={() => setPracticeLength(num)}
                      className="mr-3"
                    />
                    <div>
                      <p className="font-medium">{num} opgaver</p>
                      <p className="text-sm text-gray-600">
                        {num === 5 && 'Hurtig øvelse'}
                        {num === 10 && 'Standard øvelse'}
                        {num === 15 && 'Længere øvelse'}
                        {num === 20 && 'Grundig øvelse'}
                      </p>
                    </div>
                  </label>
                ))}
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
              <h3 className="font-bold text-lg mb-4">Lyd og vibration</h3>
              <label className="flex items-center p-3 rounded-lg cursor-pointer hover:bg-gray-50">
                <input
                  type="checkbox"
                  checked={soundEnabled}
                  onChange={(e) => {
                    setSoundEnabled(e.target.checked);
                    if (e.target.checked) {
                      playSound('click');
                    }
                  }}
                  className="mr-3"
                />
                <div className="flex items-center gap-3">
                  <Icon name={soundEnabled ? "Volume2" : "VolumeX"} className={`w-5 h-5 ${soundEnabled ? 'text-blue-500' : 'text-gray-400'}`} />
                  <div>
                    <p className="font-medium">Lyd og vibration aktiveret</p>
                    <p className="text-sm text-gray-600">Lydeffekter og haptisk feedback</p>
                  </div>
                </div>
              </label>
            </div>

            <button
              onClick={() => {
                if (window.confirm('Er du sikker på at du vil nulstille alle dine fremskridt?')) {
                  setProgress({
                    facts: {},
                    totalPoints: 0,
                    level: 1,
                    dailyStreak: 0,
                    lastPractice: null
                  });
                  alert('Dine fremskridt er blevet nulstillet!');
                }
              }}
              className="w-full p-3 text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors"
            >
              Nulstil alle fremskridt
            </button>
          </div>
        );
      };

      // Lookup table component
      const LookupTable = () => {
        const [selectedTable, setSelectedTable] = useState(5);
        
        return (
          <div className="p-4 max-w-md mx-auto">
            <div className="flex items-center gap-4 mb-6">
              <button
                onClick={() => setCurrentMode('menu')}
                className="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors"
              >
                <Icon name="ArrowLeft" className="w-5 h-5" />
                <span>Tilbage</span>
              </button>
              <h2 className="text-2xl font-bold">Gangetabeller</h2>
            </div>
            
            <div className="flex gap-2 mb-6 flex-wrap">
              {[1,2,3,4,5,6,7,8,9,10].map(n => (
                <button
                  key={n}
                  onClick={() => setSelectedTable(n)}
                  className={`px-4 py-2 rounded-lg font-medium transition-all ${
                    selectedTable === n 
                      ? 'bg-blue-500 text-white transform scale-110' 
                      : 'bg-gray-100 hover:bg-gray-200'
                  }`}
                >
                  {n}
                </button>
              ))}
            </div>
            
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h3 className="text-xl font-bold mb-4 text-center text-blue-600">{selectedTable}-tabellen</h3>
              <div className="grid grid-cols-2 gap-3">
                {[1,2,3,4,5,6,7,8,9,10].map(i => {
                  const key = `${selectedTable}x${i}`;
                  const fact = progress.facts[key];
                  const isLearned = fact && fact.correct / fact.attempts >= 0.8 && fact.attempts >= 3;
                  
                  return (
                    <div key={i} className={`p-3 rounded-lg text-center transition-all ${
                      isLearned ? 'bg-green-50 border-2 border-green-200' : 'bg-gray-50'
                    }`}>
                      <span className="text-lg font-medium">
                        {selectedTable} × {i} = {selectedTable * i}
                      </span>
                      {isLearned && (
                        <Icon name="Star" className="w-4 h-4 text-green-500 mx-auto mt-1" />
                      )}
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
        );
      };

      // Practice component
      const Practice = () => {
        useEffect(() => {
          if (!isSessionActive) {
            generateQuestion();
            setSessionStats({ correct: 0, total: 0 });
            setStreak(0);
            setShowHint(false);
            setHintUsed(false);
            setIsSessionActive(true);
          }
        }, [isSessionActive]);

        const handleEndSession = () => {
          if (sessionStats.total === 0 || window.confirm('Er du sikker på at du vil afslutte øvelsen?')) {
            setIsSessionActive(false);
            setFeedback(null);
            setShowNextButton(false);
            setCurrentMode('menu');
          }
        };

        if (!currentQuestion) return null;

        const progressPercentage = (sessionStats.total / practiceLength) * 100;

        return (
          <div className="p-4 max-w-md mx-auto">
            <div className="flex justify-between items-center mb-4">
              <button
                onClick={handleEndSession}
                className="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors"
              >
                <Icon name="ArrowLeft" className="w-5 h-5" />
                <span>Afslut</span>
              </button>
              
              <div className="flex gap-4">
                <div className="flex items-center gap-1 bg-blue-50 px-3 py-1 rounded-full">
                  <Icon name="Target" className="w-4 h-4 text-blue-500" />
                  <span className="font-medium">{sessionStats.correct}/{sessionStats.total}</span>
                </div>
                {streak > 2 && (
                  <div className="flex items-center gap-1 bg-yellow-50 px-3 py-1 rounded-full">
                    <Icon name="Zap" className="w-4 h-4 text-yellow-500" />
                    <span className="font-medium">{streak}</span>
                  </div>
                )}
              </div>
            </div>

            <div className="mb-6">
              <div className="flex justify-between text-sm text-gray-600 mb-1">
                <span>Opgave {sessionStats.total + 1} af {practiceLength}</span>
                <span>{Math.round(progressPercentage)}%</span>
              </div>
              <div className="w-full bg-gray-200 rounded-full h-3">
                <div 
                  className="bg-gradient-to-r from-blue-400 to-blue-600 h-3 rounded-full transition-all duration-300"
                  style={{ width: `${progressPercentage}%` }}
                />
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-8 mb-6">
              <h2 className="text-4xl font-bold text-center mb-8">
                {currentQuestion.a} × {currentQuestion.b} = ?
              </h2>

              {practiceType === 'multiple' ? (
                <div className="grid grid-cols-2 gap-4">
                  {currentQuestion.options.map((option, idx) => (
                    <button
                      key={idx}
                      onClick={() => {
                        if (!feedback) {
                          handleAnswer(option);
                        }
                      }}
                      disabled={feedback !== null}
                      className={`p-4 text-xl font-medium rounded-lg transition-all ${
                        feedback && option === currentQuestion.answer
                          ? 'bg-green-500 text-white transform scale-105'
                          : feedback && option !== currentQuestion.answer
                          ? 'bg-gray-200 text-gray-400'
                          : 'bg-blue-100 hover:bg-blue-200 text-blue-900 hover:transform hover:scale-105'
                      }`}
                    >
                      {option}
                    </button>
                  ))}
                </div>
              ) : (
                <div className="flex flex-col items-center gap-4">
                  <input
                    type="number"
                    value={userAnswer}
                    onChange={(e) => setUserAnswer(e.target.value)}
                    onKeyPress={(e) => {
                      if (e.key === 'Enter' && userAnswer && !feedback) {
                        handleAnswer(parseInt(userAnswer));
                      }
                    }}
                    disabled={feedback !== null}
                    className="w-32 p-4 text-2xl text-center border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                    autoFocus
                  />
                  {!feedback && (
                    <button
                      onClick={() => {
                        handleAnswer(parseInt(userAnswer));
                      }}
                      disabled={!userAnswer || feedback !== null}
                      className="px-6 py-3 bg-blue-500 text-white rounded-lg font-medium disabled:bg-gray-300 hover:bg-blue-600 transition-colors"
                    >
                      Svar
                    </button>
                  )}
                </div>
              )}

              {!feedback && !showHint && sessionStats.total > 0 && (
                <div className="mt-6 text-center">
                  <button
                    onClick={() => {
                      playSound('click');
                      setShowHint(true);
                      setHintUsed(true);
                    }}
                    className="flex items-center gap-2 mx-auto px-4 py-2 text-sm bg-yellow-100 text-yellow-800 rounded-lg hover:bg-yellow-200 transition-colors"
                  >
                    <Icon name="Lightbulb" className="w-4 h-4" />
                    Få et hint
                  </button>
                </div>
              )}

              {showHint && !feedback && (
                <div className="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800">
                  <p className="font-medium mb-1">💡 Hint:</p>
                  <p>{generateHint(currentQuestion.a, currentQuestion.b)}</p>
                </div>
              )}

              {feedback && (
                <div className={`mt-6 p-4 rounded-lg text-center ${
                  feedback.isCorrect ? 'bg-green-100' : 'bg-red-100'
                }`}>
                  {feedback.isCorrect ? (
                    <div className="flex items-center justify-center gap-2 text-green-700">
                      <Icon name="CheckCircle" className="w-6 h-6" />
                      <span className="text-lg font-medium">
                        {hintUsed ? 'Godt klaret med hjælp!' : 'Rigtigt! Fantastisk!'}
                      </span>
                    </div>
                  ) : (
                    <div className="text-red-700">
                      <Icon name="XCircle" className="w-6 h-6 mx-auto mb-2" />
                      <p className="font-medium">Ikke helt...</p>
                      <p className="text-lg mt-1">
                        {currentQuestion.a} × {currentQuestion.b} = {feedback.correctAnswer}
                      </p>
                      {!hintUsed && (
                        <p className="text-sm mt-2 text-gray-600">
                          Tip: Prøv at bruge hint-knappen næste gang!
                        </p>
                      )}
                    </div>
                  )}
                </div>
              )}

              {showNextButton && (
                <div className="mt-6 text-center">
                  <button
                    onClick={() => {
                      playSound('click');
                      if (sessionStats.total >= practiceLength - 1) {
                        handleEndSession();
                        alert(`Godt gået! Du fik ${sessionStats.correct} ud af ${practiceLength} rigtige!`);
                      } else {
                        handleNextQuestion();
                      }
                    }}
                    className="px-6 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors"
                  >
                    {sessionStats.total >= practiceLength - 1 ? 'Afslut øvelse' : 'Næste opgave →'}
                  </button>
                </div>
              )}
            </div>

            {sessionStats.total === practiceLength && (
              <div className="bg-green-50 p-4 rounded-lg text-center">
                <p className="text-lg font-medium text-green-900">
                  Øvelsen er færdig! 🎉
                </p>
                <p className="text-sm text-green-700 mt-1">
                  Du fik {sessionStats.correct} ud af {practiceLength} rigtige ({Math.round((sessionStats.correct / practiceLength) * 100)}%)
                </p>
              </div>
            )}
          </div>
        );
      };

      // Stats component
      const Stats = () => {
        const masteredFacts = Object.entries(progress.facts)
          .filter(([_, fact]) => fact.correct / fact.attempts >= 0.8 && fact.attempts >= 3)
          .length;
        
        const totalPossibleFacts = selectedTables.length * 10;
        const progressPercentage = totalPossibleFacts > 0 ? Math.round((masteredFacts / totalPossibleFacts) * 100) : 0;
        
        return (
          <div className="p-4 max-w-md mx-auto">
            <div className="flex items-center gap-4 mb-6">
              <button
                onClick={() => setCurrentMode('menu')}
                className="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors"
              >
                <Icon name="ArrowLeft" className="w-5 h-5" />
                <span>Tilbage</span>
              </button>
              <h2 className="text-2xl font-bold">Dine Fremskridt</h2>
            </div>
            
            <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-6 mb-6">
              <div className="text-center">
                <p className="text-5xl font-bold mb-2">{progressPercentage}%</p>
                <p className="text-blue-100">af valgte tabeller mestret</p>
              </div>
            </div>
            
            <div className="grid grid-cols-2 gap-4 mb-6">
              <div className="bg-white rounded-lg shadow p-4">
                <Icon name="Trophy" className="w-8 h-8 text-yellow-500 mb-2" />
                <p className="text-2xl font-bold">{progress.totalPoints}</p>
                <p className="text-sm text-gray-600">Point i alt</p>
              </div>
              
              <div className="bg-white rounded-lg shadow p-4">
                <Icon name="Star" className="w-8 h-8 text-blue-500 mb-2" />
                <p className="text-2xl font-bold">Niveau {progress.level}</p>
                <p className="text-sm text-gray-600">Dit niveau</p>
              </div>
              
              <div className="bg-white rounded-lg shadow p-4">
                <Icon name="BarChart3" className="w-8 h-8 text-green-500 mb-2" />
                <p className="text-2xl font-bold">{masteredFacts}</p>
                <p className="text-sm text-gray-600">Mestrede tal</p>
              </div>
              
              <div className="bg-white rounded-lg shadow p-4">
                <Icon name="Clock" className="w-8 h-8 text-purple-500 mb-2" />
                <p className="text-2xl font-bold">{Object.keys(progress.facts).length}</p>
                <p className="text-sm text-gray-600">Øvede tal</p>
              </div>
            </div>
            
            <div className="bg-white rounded-lg shadow p-4">
              <h3 className="font-bold mb-3">Fremskridt per tabel</h3>
              {selectedTables.length === 0 ? (
                <p className="text-gray-500 text-center py-4">
                  Ingen tabeller valgt. Gå til indstillinger for at vælge tabeller.
                </p>
              ) : (
                selectedTables.sort((a,b) => a-b).map(table => {
                  const tableFacts = Object.entries(progress.facts)
                    .filter(([key]) => key.startsWith(`${table}x`));
                  const mastered = tableFacts
                    .filter(([_, fact]) => fact.correct / fact.attempts >= 0.8 && fact.attempts >= 3)
                    .length;
                  
                  return (
                    <div key={table} className="mb-3">
                      <div className="flex justify-between text-sm mb-1">
                        <span className="font-medium">{table}-tabellen</span>
                        <span className="text-gray-600">{mastered}/10</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-3">
                        <div 
                          className="bg-gradient-to-r from-blue-400 to-blue-600 h-3 rounded-full transition-all duration-500"
                          style={{ width: `${(mastered / 10) * 100}%` }}
                        />
                      </div>
                    </div>
                  );
                })
              )}
            </div>
          </div>
        );
      };

      // Main menu
      const MainMenu = () => (
        <div className="p-4 max-w-md mx-auto">
          <div className="text-center mb-8">
            <h1 className="text-3xl font-bold mb-2">Gangetabel Træning</h1>
            <p className="text-gray-600">Lær gangetabellerne på en sjov måde!</p>
            
            {selectedTables.length === 0 && (
              <div className="mt-4 p-3 bg-amber-50 text-amber-800 rounded-lg text-sm">
                ⚠️ Du skal vælge tabeller i indstillinger før du kan øve
              </div>
            )}
          </div>

          <div className="space-y-3 mb-6">
            <button
              onClick={() => {
                playSound('click');
                setCurrentMode('practice');
              }}
              disabled={selectedTables.length === 0}
              className={`w-full rounded-lg shadow-lg p-6 text-left transition-all flex items-center gap-4 ${
                selectedTables.length === 0 
                  ? 'bg-gray-200 text-gray-400 cursor-not-allowed' 
                  : 'bg-blue-500 text-white hover:bg-blue-600 hover:shadow-xl'
              }`}
            >
              <Icon name="Play" className="w-8 h-8" />
              <div>
                <h3 className="text-xl font-bold mb-1">Start Øvelse</h3>
                <p className={selectedTables.length === 0 ? 'text-gray-400' : 'text-blue-100'}>
                  {selectedTables.length > 0 
                    ? `${practiceLength} opgaver med ${selectedTables.sort((a,b) => a-b).join(', ')}-tabellerne`
                    : 'Vælg tabeller i indstillinger først'
                  }
                </p>
              </div>
            </button>

            <button
              onClick={() => {
                playSound('click');
                setCurrentMode('lookup');
              }}
              className="w-full bg-white rounded-lg shadow-lg p-6 text-left hover:shadow-xl transition-all flex items-center gap-4"
            >
              <Icon name="Book" className="w-8 h-8 text-blue-500" />
              <div>
                <h3 className="text-xl font-bold mb-1">Se Tabeller</h3>
                <p className="text-gray-600">Slå op i alle gangetabeller</p>
              </div>
            </button>

            <button
              onClick={() => {
                playSound('click');
                setCurrentMode('stats');
              }}
              className="w-full bg-white rounded-lg shadow-lg p-6 text-left hover:shadow-xl transition-all flex items-center gap-4"
            >
              <Icon name="BarChart3" className="w-8 h-8 text-green-500" />
              <div>
                <h3 className="text-xl font-bold mb-1">Fremskridt</h3>
                <p className="text-gray-600">Se dine resultater og statistik</p>
              </div>
            </button>

            <button
              onClick={() => {
                playSound('click');
                setCurrentMode('settings');
              }}
              className="w-full bg-white rounded-lg shadow-lg p-6 text-left hover:shadow-xl transition-all flex items-center gap-4"
            >
              <Icon name="Settings" className="w-8 h-8 text-gray-500" />
              <div>
                <h3 className="text-xl font-bold mb-1">Indstillinger</h3>
                <p className="text-gray-600">Vælg tabeller og øvelsestype</p>
              </div>
            </button>
          </div>

          {progress.totalPoints > 0 && (
            <div className="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 text-center">
              <p className="text-sm text-gray-600 mb-1">Du er niveau {progress.level}</p>
              <div className="flex items-center justify-center gap-2">
                <Icon name="Trophy" className="w-5 h-5 text-yellow-500" />
                <span className="text-lg font-bold">{progress.totalPoints} point</span>
              </div>
            </div>
          )}
        </div>
      );

      return (
        <div className="min-h-screen bg-gray-100">
          {currentMode === 'menu' && <MainMenu />}
          {currentMode === 'lookup' && <LookupTable />}
          {currentMode === 'practice' && <Practice />}
          {currentMode === 'stats' && <Stats />}
          {currentMode === 'settings' && <SettingsPage />}
        </div>
      );
    };

    // Render app
    ReactDOM.render(<GangetabelApp />, document.getElementById('root'));
</script>
```

</body>
</html>
